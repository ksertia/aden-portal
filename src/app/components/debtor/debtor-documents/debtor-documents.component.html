<div class="documents-container">
  <div class="documents-header fade-in-up">
    <h1>Mes Documents</h1>
    <p>Consultez tous les documents liés à vos dossiers de recouvrement</p>
  </div>

  <div class="documents-content fade-in-up">
    <!-- Filtres -->
    <div class="filters-section">
      <div class="filters-card">
        <div class="filters-grid">
          <div class="filter-group">
            <label>Rechercher un document</label>
            <input
              type="text"
              [(ngModel)]="searchTerm"
              placeholder="Nom du document, type..."
              (input)="filterDocuments()"
            >
          </div>
          
          <div class="filter-group">
            <label>Type de document</label>
            <select [(ngModel)]="selectedDocumentType" (change)="filterDocuments()">
              <option value="">Tous les types</option>
              <option value="invoice">Factures</option>
              <option value="correspondence">Correspondances</option>
              <option value="legal_notice">Mises en demeure</option>
              <option value="payment_proof">Preuves de paiement</option>
              <option value="court_document">Documents judiciaires</option>
            </select>
          </div>
          
          <div class="filter-group">
            <label>Dossier</label>
            <select [(ngModel)]="selectedCaseId" (change)="filterDocuments()">
              <option value="">Tous les dossiers</option>
              <option *ngFor="let case of cases" [value]="case.id">
                {{ case.caseNumber }}
              </option>
            </select>
          </div>
        </div>
      </div>
    </div>

    <!-- Liste des documents -->
    <div class="documents-list" *ngIf="filteredDocuments.length > 0; else noDocuments">
      <div class="documents-grid">
        <div class="document-card" *ngFor="let doc of filteredDocuments">
          <div class="document-header">
            <div class="document-icon" [ngClass]="'icon-' + doc.type">
              <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                <polyline points="14,2 14,8 20,8"/>
              </svg>
            </div>
            <div class="document-info">
              <h3>{{ doc.name }}</h3>
              <p class="document-type">{{ getDocumentTypeLabel(doc.type) }}</p>
            </div>
            <div class="document-actions">
              <button class="btn btn-primary small" (click)="downloadDocument(doc)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                  <polyline points="7,10 12,15 17,10"/>
                  <line x1="12" y1="15" x2="12" y2="3"/>
                </svg>
                Télécharger
              </button>
              <button class="btn btn-secondary small" (click)="viewDocument(doc)">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                  <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"/>
                  <circle cx="12" cy="12" r="3"/>
                </svg>
                Voir
              </button>
            </div>
          </div>
          
          <div class="document-details">
            <div class="detail-row">
              <span class="label">Dossier :</span>
              <span class="value">{{ getCaseNumber(doc.caseId) }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Ajouté le :</span>
              <span class="value">{{ formatDate(doc.uploadedAt) }}</span>
            </div>
            <div class="detail-row">
              <span class="label">Par :</span>
              <span class="value">{{ doc.uploadedBy }}</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <ng-template #noDocuments>
      <div class="no-documents">
        <svg width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
          <polyline points="14,2 14,8 20,8"/>
        </svg>
        <h3>Aucun document trouvé</h3>
        <p>Aucun document ne correspond aux critères sélectionnés.</p>
      </div>
    </ng-template>
  </div>

  <!-- Modal de visualisation -->
  <div class="modal-overlay" *ngIf="showViewModal" (click)="closeViewModal()">
    <div class="modal-content large" (click)="$event.stopPropagation()">
      <div class="modal-header">
        <h3>{{ selectedDocument?.name }}</h3>
        <button class="modal-close" (click)="closeViewModal()">
          <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <line x1="18" y1="6" x2="6" y2="18"/>
            <line x1="6" y1="6" x2="18" y2="18"/>
          </svg>
        </button>
      </div>
      <div class="modal-body" *ngIf="selectedDocument">
        <div class="document-preview">
          <div class="preview-placeholder">
            <svg width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14,2 14,8 20,8"/>
            </svg>
            <p>Aperçu du document</p>
            <p class="preview-note">{{ getDocumentTypeLabel(selectedDocument.type) }}</p>
          </div>
        </div>
      </div>
      <div class="modal-footer">
        <button class="btn btn-secondary" (click)="closeViewModal()">Fermer</button>
        <button class="btn btn-primary" (click)="downloadDocument(selectedDocument!)">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
            <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
            <polyline points="7,10 12,15 17,10"/>
            <line x1="12" y1="15" x2="12" y2="3"/>
          </svg>
          Télécharger
        </button>
      </div>
    </div>
  </div>
</div>
